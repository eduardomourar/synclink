{
  "version": 3,
  "sources": ["../../src/node-adapter.ts"],
  "sourcesContent": ["/**\n * Copyright 2019 Google Inc. All Rights Reserved.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *     http://www.apache.org/licenses/LICENSE-2.0\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Endpoint } from \"./protocol\";\n\nexport interface NodeEndpoint {\n  postMessage(message: any, transfer?: any[]): void;\n  on(\n    type: string,\n    listener: EventListenerOrEventListenerObject,\n    options?: {},\n  ): void;\n  off(\n    type: string,\n    listener: EventListenerOrEventListenerObject,\n    options?: {},\n  ): void;\n  start?: () => void;\n}\n\nexport default function nodeEndpoint(nep: NodeEndpoint): Endpoint {\n  const listeners = new WeakMap();\n  return {\n    postMessage: nep.postMessage.bind(nep),\n    addEventListener: (_, eh) => {\n      const l = (data: any) => {\n        if (\"handleEvent\" in eh) {\n          eh.handleEvent({ data } as MessageEvent);\n        } else {\n          eh({ data } as MessageEvent);\n        }\n      };\n      nep.on(\"message\", l);\n      listeners.set(eh, l);\n    },\n    removeEventListener: (_, eh) => {\n      const l = listeners.get(eh);\n      if (!l) {\n        return;\n      }\n      nep.off(\"message\", l);\n      listeners.delete(eh);\n    },\n    start: nep.start && nep.start.bind(nep),\n  };\n}\n"],
  "mappings": ";;;;;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AA8Be,SAAR,aAA8B,KAA6B;AAChE,QAAM,YAAY,oBAAI,QAAQ;AAC9B,SAAO;AAAA,IACL,aAAa,IAAI,YAAY,KAAK,GAAG;AAAA,IACrC,kBAAkB,CAAC,GAAG,OAAO;AAC3B,YAAM,IAAI,wBAAC,SAAc;AACvB,YAAI,iBAAiB,IAAI;AACvB,aAAG,YAAY,EAAE,KAAK,CAAiB;AAAA,QACzC,OAAO;AACL,aAAG,EAAE,KAAK,CAAiB;AAAA,QAC7B;AAAA,MACF,GANU;AAOV,UAAI,GAAG,WAAW,CAAC;AACnB,gBAAU,IAAI,IAAI,CAAC;AAAA,IACrB;AAAA,IACA,qBAAqB,CAAC,GAAG,OAAO;AAC9B,YAAM,IAAI,UAAU,IAAI,EAAE;AAC1B,UAAI,CAAC,GAAG;AACN;AAAA,MACF;AACA,UAAI,IAAI,WAAW,CAAC;AACpB,gBAAU,OAAO,EAAE;AAAA,IACrB;AAAA,IACA,OAAO,IAAI,SAAS,IAAI,MAAM,KAAK,GAAG;AAAA,EACxC;AACF;AAzBwB;",
  "names": []
}
